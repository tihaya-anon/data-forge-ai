# DataForge AI - 任务清单
# 
# 本文件集中定义所有任务及其依赖关系，用于：
# 1. 生成任务依赖 DAG 图
# 2. 分析并行度和关键路径
# 3. 指导 AI Agent 分配
#
# 使用方法：
#   make task-dag      # 生成 DAG 可视化图
#   make task-analyze  # 分析并行度和建议 agent 数量

# =============================================================================
# 项目元信息
# =============================================================================
项目:
  名称: "DataForge AI"
  描述: "大数据 + AI 平台演示项目"
  预估总工时: null          # 自动计算

# =============================================================================
# 任务定义
# =============================================================================
# 
# 字段说明：
#   编号: 唯一标识，格式 T-001
#   名称: 简短描述
#   工时: 预估小时数
#   依赖: 前置任务编号列表（无依赖则为空数组）
#   范围: 允许修改的文件路径
#   描述: 详细说明（可选）
#   状态: 待处理 | 进行中 | 已完成 | 已阻塞
#   分配: agent 编号（执行时填写）

任务:
  # ---------------------------------------------------------------------------
  # 第一层：基础设施（无依赖，可完全并行）
  # ---------------------------------------------------------------------------
  - 编号: "T-001"
    名称: "Docker 基础配置"
    工时: 2
    依赖: []
    状态: "待处理"
    范围:
      - "docker/compose.base.yml"
      - "docker/compose.storage.yml"
    描述: |
      配置 Docker 网络、卷、基础存储服务（Kafka, Redis, MinIO）

  - 编号: "T-002"
    名称: "Makefile 框架搭建"
    工时: 2
    依赖: []
    状态: "待处理"
    范围:
      - "Makefile"
      - "makefiles/*.mk"
    描述: |
      完善 Makefile 命令结构，添加开发、测试、部署命令

  - 编号: "T-003"
    名称: "CI/CD 流水线"
    工时: 3
    依赖: []
    状态: "待处理"
    范围:
      - ".github/workflows/"
    描述: |
      配置 GitHub Actions，自动测试、构建、生成文档

  # ---------------------------------------------------------------------------
  # 第二层：核心模块（依赖基础设施）
  # ---------------------------------------------------------------------------
  - 编号: "T-004"
    名称: "Kafka Producer 模块"
    工时: 6
    依赖: ["T-001"]
    状态: "待处理"
    范围:
      - "src/pipeline/kafka/producer/"
      - "tests/pipeline/kafka/producer/"
    描述: |
      实现 Kafka 消息生产者，支持批量发送、重试、监控

  - 编号: "T-005"
    名称: "Kafka Consumer 模块"
    工时: 6
    依赖: ["T-001"]
    状态: "待处理"
    范围:
      - "src/pipeline/kafka/consumer/"
      - "tests/pipeline/kafka/consumer/"
    描述: |
      实现 Kafka 消息消费者，支持分组消费、偏移管理

  - 编号: "T-006"
    名称: "配置管理模块"
    工时: 4
    依赖: ["T-002"]
    状态: "待处理"
    范围:
      - "src/common/config/"
      - "tests/common/config/"
    描述: |
      统一配置加载，支持环境变量、配置文件、远程配置

  # ---------------------------------------------------------------------------
  # 第三层：数据处理（依赖核心模块）
  # ---------------------------------------------------------------------------
  - 编号: "T-007"
    名称: "Spark 批处理作业"
    工时: 8
    依赖: ["T-004", "T-006"]
    状态: "待处理"
    范围:
      - "src/pipeline/spark/"
      - "tests/pipeline/spark/"
    描述: |
      实现数据清洗、去重、质量过滤的 Spark 作业

  - 编号: "T-008"
    名称: "Flink 流处理作业"
    工时: 8
    依赖: ["T-005", "T-006"]
    状态: "待处理"
    范围:
      - "src/pipeline/flink/"
      - "tests/pipeline/flink/"
    描述: |
      实现实时数据处理的 Flink 作业

  # ---------------------------------------------------------------------------
  # 第四层：RAG 模块（依赖数据处理）
  # ---------------------------------------------------------------------------
  - 编号: "T-009"
    名称: "向量化服务"
    工时: 6
    依赖: ["T-007"]
    状态: "待处理"
    范围:
      - "src/rag/embedding/"
      - "tests/rag/embedding/"
    描述: |
      文档向量化服务，集成 Milvus

  - 编号: "T-010"
    名称: "检索服务"
    工时: 6
    依赖: ["T-007", "T-008"]
    状态: "待处理"
    范围:
      - "src/rag/retrieval/"
      - "tests/rag/retrieval/"
    描述: |
      混合检索服务，向量 + BM25 + 重排序

  # ---------------------------------------------------------------------------
  # 第五层：集成测试（依赖所有模块）
  # ---------------------------------------------------------------------------
  - 编号: "T-011"
    名称: "端到端集成测试"
    工时: 4
    依赖: ["T-009", "T-010"]
    状态: "待处理"
    范围:
      - "tests/e2e/"
      - "tests/integration/"
    描述: |
      完整流程的集成测试

# =============================================================================
# DAG 配置（用于生成可视化）
# =============================================================================
DAG配置:
  输出目录: "docs/diagrams"
  输出文件: "task-dag.d2"
  主题: 200
  布局: "dagre"              # dagre 更适合 DAG 布局
  
  # 状态对应的颜色
  状态颜色:
    待处理: "#9E9E9E"        # 灰色
    进行中: "#2196F3"        # 蓝色
    已完成: "#4CAF50"        # 绿色
    已阻塞: "#F44336"        # 红色
